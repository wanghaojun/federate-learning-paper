**How to Exchange Secrets with Oblivious Transfer**

Michael O. Rabin                 

​                                                                                                                                                                     **by Liu Yangchen**

### 1 Introduction

Bob和Alice分别拥有一个他们希望交换的秘密SB和SA。 例如，SB可能是Alice想要访问的文件的密码（我们将此文件称为Alice的文件），而SA可能是Bob的文件的密码。 他们是否可以建立一个协议来交换机密信息，而无需使用受信任的第三方，也不需要安全的机制来同时交换消息？

为了排除随机化可能使用的密码位数的可能性，我们假设如果使用了错误的密码，那么该文件将被删除，并且Bob和Alice希望保证在各自的文件中不会发生这种情况。 基于此假设，我们可以不失一般性地将SA和SB设为单bits。

如前所述，没有什么可以预防Bob给Alice提供错误的密码S的，甚至可能是为了交换正确的机密SA。 现在，Bob将读取他的文件，而Alice使用S ≠ SB将销毁她的文件。

我们假设正确的密码SB和SA被无可替代地转录为Alice和Bob文件的前缀。 此外，爱丽丝（Alice）和鲍勃（Bob）有一个程序，可以向彼此提供已签名的消息（合同），并且可以诉诸随后的裁决来证明欺诈。

在这种情况下，鲍勃可以向爱丽丝发送消息，例如：==“我的秘密是S，签名Bob”==。 如果Alice现在使用密码S并且S ≠ SB，则她的文件（除了包含SB的前缀之外）都将被破坏，并且Alice可以对Bob进行可证明的案件裁决。

但是，上述消息未提供EOS问题的解决方案。爱丽丝可以接收已签名的消息，并且无需向鲍勃提供SA就可以读取她的文件。 当鲍勃（Bob）出庭时，爱丽丝（Alice）可以说：==“我给鲍勃（Bob）设置了密码SA，但他没有使用它。 我现在愿意再次透露它。”== 即使鲍勃在裁决时获得了SA，爱丽丝也已经通过提前阅读文件而获得了优势。

基于以上所有假设，问题似乎仍然无法解决。 任何EOS协议都必须采用以下形式：Alice向Bob提供一些信息$I_1$，Bob向Alice提供$J_1$，Alice向Bob 提供$I_2$等，等等。必须存在一个$k$，例如，Bob可以从$I_1,...,I_k$确定SA；而Alice无法根据$J_1,...,J_{k-1}$确定SB。 鲍勃可以从爱丽丝那里隐瞒$J_k$的身份，从而在不透露SB的情况下获得SA。

解决此难题的方法是构造一个EOS协议，这样，根据Bob知道SA的事实，Alice可以推断出SB。

为了使其可行，我们做出最终假设：如果Bob使用SA读取他的文件，那么Alice知道这一点，反之亦然。

Richard DeMillo为我们提出了没有上面讨论的特定设置和假设的秘密交换的一般问题。

### 2 The EOS Protocol  

我们假设Alice有一个公共密钥$K_A$，而Bob有一个公共密钥$K_B$，他们可以将其用于加密和数字签名。 爱丽丝发给鲍勃的每条消息都将由她使用$K_A$签名，对于鲍勃也是如此。

爱丽丝选择两个大素数$p，q$并创建一个一次性密钥$n_A = p·q$。 然后，她向鲍勃发送了一条消息：==“一次性密钥为$n_A$，爱丽丝已签名”==。 鲍勃选择素数$p_1，q_1$，并在签名消息中将$n_B = p_1·q_1$给予Alice。

现在，Bob随机选择一个$x≤n_A$，计算$c = x^2 modn_A$，并向Alice发送以下消息：==“ $E_{KB}（x）$是我所选择的数字被我的公钥$K_B$加密后的结果，而$c$是该数字的平方mod nA， 鲍勃已签名”==。

知道$n_A$的素数分解$p，q$的爱丽丝，计算$x_1$，使得$x_1^2 = c  mod  nA$。  （有关平方根提取算法和以下段落中使用的事实，请参见[2]。）Alice现在向Bob传达了以下信息：“ $x_1$是$c$的平方根模$n_A$，Alice已签名”。

鲍勃计算g.c.d $\left(x-x_{1}, n_{A}\right)=d$。 有1/2的概率，我们有$[d=p$ or $d=q]$，因此在概率为1/2的情况下，鲍勃现在的因子分解为$n_A = p·q$。 但是，由于爱丽丝不知道鲍勃的$x$，所以她也不知道鲍勃是否具有$n_A$的因式分解。

我们将这种信息传输模式称为不经意传输，在这种模式下，==发件人不知道收件人是否实际收到了信息==。

接下来，鲍勃将$n_B$不经意传输给了爱丽丝。

定义:

$$\nu_{B}=\left\{\begin{array}{ll}0 & \text { if }\left(x-x_{1}, n_{A}\right)=p \text { or } q \\ 1 & \text { otherwise }\end{array}\right.$$

因此，在上述将$n_A$的因式分解从爱丽丝转移到鲍勃之后，当且仅当，鲍勃知道了这些素数因子,$ν_B=0$。爱丽丝的$ν_A$位定义与此类似。

回想一下，SA和SB都是单个bit。 鲍勃形成异或$\varepsilon_{B}=S_{B} \oplus \nu_{B}$（阅读器：$S_B = SB！$），并在签名消息中将其提供给爱丽丝”，“ B是我秘密的异或，同时表明我对$n_A$素数因子的“了解程度 ”，鲍勃已签名。$\varepsilon_{B}$中的” 了解程度“ 对Alice的访问文件没有任何帮助。

同样，爱丽丝形成“ $\varepsilon_{A}=S_{A} \oplus \nu_{A}$”，并在签名消息中将其交给鲍勃。

我们来到了EOS协议的最后一轮。 爱丽丝将她的秘钥SA放置在随机消息$m_A$的中心位。 然后，她将$m_A$加密为$E_{n_{A}}\left(m_{A}\right)=C$。 使用需要因子$p,q$的任何公钥系统 的$n_A$用于解码。  （例如，我们可以使用[1]的$E_{n_{A}}\left(m_{A}\right)={m_{A}}^2mod{n_A}$加密，前提是我们有一个固定的$m_A$小前缀以区分$E_{n_{A}}\left(m_{A}\right)$的4个平方根$mod{n_A}$中的$m_A$。）Alice 在签名消息中将$d_A=E_{n_{A}}\left(m_{A}\right)$发送给Bob。

Bob使用$S_B$和$n_B$遵循相同的步骤，并将加密结果发送给Alice。

**定理1**在导言中的假设下，以上协议提供了“秘密交换问题”的解决方案。 双方均不会获得对方的机密的概率为1/ 4。

**证明** 我们忽略了证明，证明爱丽丝与鲍勃之间交换的已签名消息以及文件中SA和SB的不可磨灭地结合在一起，如果另一个参与者被骗了，则可以为每个参与者提供可证明的证据。

很明显，如果爱丽丝或鲍勃在最后阶段之前停止参与EOS协议，在这种情况下，另一方也将停止，那么任何一方都不知道对方的秘密。

假设在最后阶段，爱丽丝已经给鲍勃已加密的秘文$d_{A}=E_{n_{A}}\left(m_{A}\right)$ 了。 如果鲍勃实际上知道因式分解$n_A = p·q$，在这种情况下$ν_B= 0$，则他可以解码$d_A$，找到$m_A$和$S_A$。 如果Bob现在使用密码（bit）SA来读取他的文件，那么通过假设，Alice将知道这一点。 同样，通过假设，Bob仅在确定地知道SA时才尝试读取他的文件（错误将破坏该文件）。 因此，爱丽丝知道$ν_B= 0$，因此知道“ $\varepsilon_{B}=S_{B} \oplus \nu_{B}$，因此她知道SB。

如果鲍勃在最后阶段给了爱丽丝$d_B=E_{n_{B}}\left(m_{B}\right)$，则上述论证适用于：如果爱丽丝在鲍勃之前读取了她的文件，那么鲍勃将知道SA。

==因此，如果爱丽丝或鲍勃读取了她或他的文件，则另一人将知道他或她的文件的密码。==

协议完成后，每个人都不知道另一个人的秘密的概率为${（1/2）}^2=1/4$。

**备注1**在未进行秘密交换的情况下，不可能重复该过程。一个参与者,例如爱丽丝实际上可能在第一轮之后就知道了SB，但是故意在第二轮之后才访问她的文件。 鲍勃可能不知道第一轮或第二轮中$ν_A$是否为0，然后将无法读取他的文件。

**备注2**通过修改信息子协议的不经意传输，可以提高EOS协议成功的可能性。 在从爱丽丝那里收到$n_A$后，鲍勃选择了两个数字$x,y≤n_A$并给Alice平方$x^2,y^2 mod n_A$。 爱丽丝给鲍勃两个平方根$x_1,y_1 mod n_A$分别为$x^2$和$y^2$的。 现在Bob知道分解系数$n_A = p·q$的概率为3 /4。

当鲍伯给爱丽丝“$\varepsilon_{B}=S_{B} \oplus \nu_{B}$”时，她知道$\varepsilon_{B}=S_{B}$概率为3 /4， 由于我们假设爱丽丝决心保证不会删除其文件，因此仍然可以得出结论，她不会使用$\varepsilon_{B}$作为密码。而是像以前一样，她将一直等到她可以通过解密$E_{n_{B}}\left(m_{B}\right)$来读取SB。或者可以从Bob访问过他的文件这一事实推断出$ν_B= 0$。

鲍勃到爱丽丝也进行了上述信息的转移的两次重复。  EOS协议的其余部分与以前一样。

现在，每个参与者只有1 / 4的概率不知道对方一次性密钥的分解。 因此，EOS协议未终止的概率为${（1/4）}^2=1/16$。

存在一个限制，超出该限制不能进行以上增强。 例如，如果修改了不经意传输子协议，以使Pr [$ν_B$= 0]〜1 / 32,000，则Pr [$\varepsilon_{B}=S_{B}$] = 1-1/ 32,000。现在，爱丽丝面临一种诱惑来终止协议。 收到$\varepsilon_{B}$后，并使用$\varepsilon_{B}$作为她文件的密码。

**3 Conclusion**

让我们提及一些需要进一步研究的问题。

即使没有我们为了使EOS可行而做的任何假设，信息子协议的不经意传输也是有效的。 该子协议还能找到哪些其他应用程序？

我们所做的任何假设都可以放宽或消除而不会失去EOS的可能性吗？

是否可以构建一个始终终止的EOS协议，或者可以证明非终止的非零概率至关重要？

